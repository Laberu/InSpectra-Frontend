(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[144],{487:(e,t,r)=>{Promise.resolve().then(r.bind(r,9246))},9246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(7437),n=r(2303),a=r(6463),l=r(2265);function i(e){let{children:t}=e,{user:r,loading:i}=(0,n.a)(),o=(0,a.useRouter)();return((0,l.useEffect)(()=>{i||r||o.push("/login")},[r,i,o]),i)?(0,s.jsx)("div",{children:"Loading..."}):r?(0,s.jsx)(s.Fragment,{children:t}):null}var o=r(7776),c=r(8938),d=r(8674),u=r(9582);r(7514);let h=e=>{let{modelUrl:t,textureSets:r,modelInfos:n}=e,a=(0,l.useRef)(null),i=(0,l.useRef)(null),h=(0,l.useRef)(null),x=(0,l.useRef)(null),m=(0,l.useRef)(null),p=(0,l.useRef)(null),[g,j]=(0,l.useState)(!0),[f,v]=(0,l.useState)("#d3d3d3"),[A,D]=(0,l.useState)(1),[y,M]=(0,l.useState)("setA"),[N,_]=(0,l.useState)(null),{positions:P=[],modelInfo:S={}}=n||{},[w,C]=(0,l.useState)({general:!1,lighting:!1,textures:!1,camera:!1}),z={position:[50,50,100],target:[0,0,0]},b=e=>{C(t=>({...t,[e]:!t[e]}))},E=(e,t,r)=>{e.traverse(e=>{e.isMesh&&e.material&&(Array.isArray(e.material)?e.material:[e.material]).forEach(e=>{let s=t[e.name];if(s){let t=r.load(s);t.wrapS=t.wrapT=o.rpg,e.map=t,e.needsUpdate=!0}})})},k=e=>{let t=P[e];if(!t||!p.current||!h.current)return;let{position:r,rotationTarget:s}=t;u.p8.to(p.current.position,{x:r.x,y:r.y,z:r.z,duration:1.5,ease:"power2.inOut",onUpdate:()=>{p.current.lookAt(s.x,s.y,s.z)},onComplete:()=>{h.current.target.set(s.x,s.y,s.z),h.current.update(),_(t)}})};return(0,l.useEffect)(()=>{if(!a.current)return;let e=new o.xsS,s=new o.cPb(75,a.current.clientWidth/a.current.clientHeight,.1,1e4);s.position.set(...z.position),p.current=s;let n=i.current;n||((n=new o.CP7({antialias:!0})).setSize(a.current.clientWidth,a.current.clientHeight),n.setPixelRatio(Math.min(window.devicePixelRatio,1.5)),n.shadowMap.enabled=!1,n.autoClear=!0,i.current=n),a.current.appendChild(n.domElement),n.setClearColor(f);let l=new o.Mig(0xffffff,A);m.current=l,e.add(l);let u=new c.z(s,n.domElement);u.enableDamping=!0,u.dampingFactor=.1,u.maxDistance=8e3,h.current=u,u.target.set(...z.target),u.update(),(()=>{if(!t)return;j(!0);let s=new d.y,n=new o.dpR;s.load(t,t=>{x.current=t,e.add(t),E(t,r[y],n),j(!1)},void 0,e=>{console.error("Error loading model:",e),j(!1)})})();let g=()=>{n.clear(),u.update(),n.render(e,s),requestAnimationFrame(g)};g();let v=()=>{if(!s||!n||!a.current)return;let e=a.current.clientWidth,t=a.current.clientHeight;s.aspect=e/t,s.updateProjectionMatrix(),n.setSize(e,t)};return window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v),u.dispose(),n.dispose(),x.current&&x.current.traverse(e=>{if(e.isMesh&&(e.geometry.dispose(),e.material)){if(Array.isArray(e.material))e.material.forEach(e=>{var t;null===(t=e.map)||void 0===t||t.dispose(),e.dispose()});else{var t;null===(t=e.material.map)||void 0===t||t.dispose(),e.material.dispose()}}}),e.clear()}},[t]),(0,l.useEffect)(()=>{m.current&&(m.current.intensity=A)},[A]),(0,l.useEffect)(()=>{i.current&&i.current.setClearColor(f)},[f]),(0,l.useEffect)(()=>{if(x.current){let e=new o.dpR;E(x.current,r[y],e)}},[y]),(0,s.jsxs)("div",{className:"viewer-container",children:[(0,s.jsxs)("div",{className:"tools-bar",children:[(0,s.jsx)("h2",{children:"Project"}),(0,s.jsxs)("div",{className:"tools-section",children:[(0,s.jsxs)("div",{className:"tools-header",onClick:()=>b("general"),children:["General Settings ",w.general?"▲":"▼"]}),w.general&&(0,s.jsxs)("div",{className:"tools-content",children:[(0,s.jsx)("label",{children:"Background Color:"}),(0,s.jsx)("input",{type:"color",value:f,onChange:e=>v(e.target.value)})]})]}),(0,s.jsxs)("div",{className:"tools-section",children:[(0,s.jsxs)("div",{className:"tools-header",onClick:()=>b("lighting"),children:["Lighting ",w.lighting?"▲":"▼"]}),w.lighting&&(0,s.jsxs)("div",{className:"tools-content",children:[(0,s.jsx)("label",{children:"Global Light Intensity:"}),(0,s.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:A,onChange:e=>D(parseFloat(e.target.value))})]})]}),(0,s.jsxs)("div",{className:"tools-section",children:[(0,s.jsxs)("div",{className:"tools-header",onClick:()=>b("textures"),children:["Textures ",w.textures?"▲":"▼"]}),w.textures&&(0,s.jsxs)("div",{className:"tools-content",children:[(0,s.jsx)("label",{children:"Select Texture Set:"}),(0,s.jsx)("select",{value:y,onChange:e=>M(e.target.value),children:Object.keys(r).map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"tools-section",children:[(0,s.jsxs)("div",{className:"tools-header",onClick:()=>b("camera"),children:["Camera ",w.camera?"▲":"▼"]}),w.camera&&(0,s.jsxs)("div",{className:"tools-content",children:[P.map((e,t)=>(0,s.jsx)("button",{onClick:()=>k(t),children:e.name},t)),(0,s.jsx)("button",{onClick:()=>{p.current&&h.current&&u.p8.to(p.current.position,{x:z.position[0],y:z.position[1],z:z.position[2],duration:1.5,ease:"power2.inOut",onUpdate:()=>{p.current.lookAt(z.target[0],z.target[1],z.target[2])},onComplete:()=>{h.current.target.set(...z.target),h.current.update()}})},children:"Reset Camera"})]})]})]}),(0,s.jsx)("div",{ref:a,style:{width:"100%",height:"100%"}}),N&&(0,s.jsxs)("div",{className:"info-panel",children:[(0,s.jsxs)("div",{className:"info-panel__image",children:[(0,s.jsx)("img",{src:"https://via.placeholder.com/600x300",alt:"Defect Detail"}),(0,s.jsx)("button",{className:"info-panel__close",onClick:()=>{_(null)},children:"✖"})]}),(0,s.jsx)("div",{className:"info-panel__header",children:(0,s.jsx)("p",{children:"Defect N/A"})}),(0,s.jsx)("div",{className:"info-panel__table",children:(0,s.jsx)("table",{children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Inspector"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Position"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Date"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Damage Types"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Accuracy"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Damage Levels"}),(0,s.jsx)("td",{children:"N/A"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Verified"}),(0,s.jsx)("td",{children:"N/A"})]})]})})}),(0,s.jsxs)("div",{className:"info-panel__details",children:[(0,s.jsx)("h4",{children:"Additional Details"}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Location:"})," N/A"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Damage Area:"})," N/A"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Damage Depth:"})," N/A"]})]})]})]})};async function x(e){return"/models/".concat(e,".fbx")}async function m(e){return({Dam_Phrae:{setA:{"DAM.1001":"/textures/Dam_Phrae/setA/DAM.1001.jpg","DAM.1002":"/textures/Dam_Phrae/setA/DAM.1002.jpg"},setB:{"DAM.1001":"/textures/Dam_Phrae/setB/DAM.1001.jpg","DAM.1002":"/textures/Dam_Phrae/setB/DAM.1002.jpg"}},Another_Model:{setA:{Material1:"/textures/Another_Model/setA/Material1.jpg",Material2:"/textures/Another_Model/setA/Material2.jpg"},setB:{Material1:"/textures/Another_Model/setB/Material1.jpg",Material2:"/textures/Another_Model/setB/Material2.jpg"}},overallDOH:{setA:{"DAM.1001":"/textures/Dam_Phrae/setA/DAM.1001.jpg","DAM.1002":"/textures/Dam_Phrae/setA/DAM.1002.jpg"},setB:{"DAM.1001":"/textures/Dam_Phrae/setB/DAM.1001.jpg","DAM.1002":"/textures/Dam_Phrae/setB/DAM.1002.jpg"}}})[e]}async function p(e){return({Dam_Phrae:{positions:[{name:"Position 1",position:{x:50,y:50,z:100},rotationTarget:{x:0,y:0,z:0}},{name:"Position 2",position:{x:0,y:30,z:50},rotationTarget:{x:10,y:10,z:10}}],modelInfo:{name:"Dam Phrae",vertices:12e3,faces:6e3}},Another_Model:{positions:[{name:"Position 1",position:{x:10,y:20,z:30},rotationTarget:{x:0,y:0,z:0}},{name:"Position 2",position:{x:40,y:50,z:60},rotationTarget:{x:10,y:10,z:10}}],modelInfo:{name:"Another Model",vertices:8e3,faces:4e3}},overallDOH:{positions:[{name:"Position 1",position:{x:15,y:25,z:35},rotationTarget:{x:0,y:0,z:0}},{name:"Position 2",position:{x:45,y:55,z:65},rotationTarget:{x:10,y:10,z:10}}],modelInfo:{name:"Overall DOH",vertices:15e3,faces:7500}}})[e]||null}function g(){let{modelId:e}=(0,a.useParams)(),[t,r]=(0,l.useState)(null),[n,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(null);return((0,l.useEffect)(()=>{(async()=>{try{let t=await x(e),s=await m(e),n=await p(e);r(t),o(s),d(n)}catch(e){console.error("Error fetching model or textures:",e)}})()},[e]),t&&n&&c)?(0,s.jsx)(i,{children:(0,s.jsx)("div",{children:(0,s.jsx)(h,{modelUrl:t,textureSets:n,modelInfos:c})})}):(0,s.jsx)("div",{children:"Loading..."})}},2303:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>l,a:()=>i});var s=r(7437),n=r(2265);let a=(0,n.createContext)();function l(e){let{children:t}=e,[r,l]=(0,n.useState)(null),[i,o]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=localStorage.getItem("accesstoken"),t=localStorage.getItem("user");if(e&&"undefined"!==e&&o(e),t&&"undefined"!==t)try{l(JSON.parse(t))}catch(e){console.error("Error parsing stored user data:",e),localStorage.removeItem("user")}},[]),(0,s.jsx)(a.Provider,{value:{user:r,accesstoken:i,login:(e,t)=>{l(e),o(t),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accesstoken",t)},logout:()=>{l(null),o(null),localStorage.removeItem("user"),localStorage.removeItem("accesstoken")}},children:t})}let i=()=>(0,n.useContext)(a)},7514:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[741,689,922,720,130,215,744],()=>t(487)),_N_E=e.O()}]);